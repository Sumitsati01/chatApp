{"ast":null,"code":"import _slicedToArray from\"/home/user/React/git/chat/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{doc,onSnapshot}from'firebase/firestore';import React from'react';import{useState,useEffect,useContext}from'react';import{AuthContext}from'../context/authContext';import{ChatContext}from'../context/chatContext';import{db}from'../Pages/Firebase';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Chats(){var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var _useContext2=useContext(ChatContext),dispatch=_useContext2.dispatch;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chats=_useState2[0],setChats=_useState2[1];useEffect(function(){var getChats=function getChats(){var unsub=onSnapshot(doc(db,\"userChats\",currentUser.uid),function(doc){var _Object$entries;var chatt=[];(_Object$entries=Object.entries(doc.data()))===null||_Object$entries===void 0?void 0:_Object$entries.map(function(chat){if(chat[0]!=='undefined'){chatt.push(chat);}return 1;});setChats([].concat(chatt));});return function(){unsub();};};currentUser.uid&&getChats();},[currentUser.uid]);var handleSelect=function handleSelect(user){dispatch({type:\"CHANGE_USER\",payload:user});};return/*#__PURE__*/_jsx(\"div\",{className:\"chats\",children:chats.sort(function(a,b){return b[1].date-a[1].date;}).map(function(chat){var _chat$,_chat$$userInfo,_chat$2,_chat$2$userInfo,_chat$3,_chat$3$lastMessage,_chat$4,_chat$4$lastMessage;return/*#__PURE__*/_jsxs(\"div\",{className:\"userChat\",onClick:function onClick(){return handleSelect(chat[1].userInfo);},children:[/*#__PURE__*/_jsx(\"img\",{src:(_chat$=chat[1])!==null&&_chat$!==void 0&&(_chat$$userInfo=_chat$.userInfo)!==null&&_chat$$userInfo!==void 0&&_chat$$userInfo.photoURL?chat[1].userInfo.photoURL:' ',alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"userChatInfo\",children:[/*#__PURE__*/_jsx(\"span\",{children:(_chat$2=chat[1])===null||_chat$2===void 0?void 0:(_chat$2$userInfo=_chat$2.userInfo)===null||_chat$2$userInfo===void 0?void 0:_chat$2$userInfo.displayName}),/*#__PURE__*/_jsx(\"p\",{children:(_chat$3=chat[1])!==null&&_chat$3!==void 0&&(_chat$3$lastMessage=_chat$3.lastMessage)!==null&&_chat$3$lastMessage!==void 0&&_chat$3$lastMessage.text?(_chat$4=chat[1])===null||_chat$4===void 0?void 0:(_chat$4$lastMessage=_chat$4.lastMessage)===null||_chat$4$lastMessage===void 0?void 0:_chat$4$lastMessage.text:' '})]})]},chat[0]);})});}export default Chats;","map":null,"metadata":{},"sourceType":"module"}